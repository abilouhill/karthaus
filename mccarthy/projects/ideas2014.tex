\documentclass[11pt,final]{amsart}%default 10pt
%prepared in AMSLaTeX, under LaTeX2e

\usepackage[total={6.2in,9.0in},top=1.2in,left=1.1in]{geometry}

\usepackage{natbib}

\usepackage{amssymb,alltt,verbatim,xspace,fancyvrb,color,empheq}
\usepackage{palatino}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{underscore}

% check if we are compiling under latex or pdflatex
\ifx\pdftexversion\undefined
  \usepackage[final,dvips]{graphicx}
\else
  \usepackage[final,pdftex]{graphicx}
\fi

% hyperref should be the last package we load
\usepackage[pdftex,
                colorlinks=true,
                plainpages=false, % only if colorlinks=true
                linkcolor=blue,   % only if colorlinks=true
                citecolor=black,   % only if colorlinks=true
                urlcolor=magenta     % only if colorlinks=true
]{hyperref}

\newcommand{\normalspacing}{\renewcommand{\baselinestretch}{1.05}\tiny\normalsize}
\newcommand{\tablespacing}{\renewcommand{\baselinestretch}{1.0}\tiny\normalsize}
\normalspacing

% math macros
\newcommand\bG{\mathbf{G}}
\newcommand\bv{\mathbf{v}}
\newcommand\bV{\mathbf{V}}
\newcommand\bq{\mathbf{q}}
\newcommand\bQ{\mathbf{Q}}

\newcommand\CC{\mathbb{C}}
\newcommand{\DDt}[1]{\ensuremath{\frac{d #1}{d t}}}
\newcommand{\ddt}[1]{\ensuremath{\frac{\partial #1}{\partial t}}}
\newcommand{\ddx}[1]{\ensuremath{\frac{\partial #1}{\partial x}}}
\newcommand{\ddy}[1]{\ensuremath{\frac{\partial #1}{\partial y}}}
\newcommand{\ddxp}[1]{\ensuremath{\frac{\partial #1}{\partial x'}}}
\newcommand{\ddz}[1]{\ensuremath{\frac{\partial #1}{\partial z}}}
\newcommand{\ddxx}[1]{\ensuremath{\frac{\partial^2 #1}{\partial x^2}}}
\newcommand{\ddyy}[1]{\ensuremath{\frac{\partial^2 #1}{\partial y^2}}}
\newcommand{\ddxy}[1]{\ensuremath{\frac{\partial^2 #1}{\partial x \partial y}}}
\newcommand{\ddzz}[1]{\ensuremath{\frac{\partial^2 #1}{\partial z^2}}}
\newcommand{\Div}{\nabla\cdot}
\newcommand\eps{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\ihat}{\mathbf{i}}
\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}
\newcommand{\jhat}{\mathbf{j}}
\newcommand{\khat}{\mathbf{k}}
\newcommand{\nhat}{\mathbf{n}}
\newcommand\lam{\lambda}
\newcommand\lap{\triangle}
\newcommand\Matlab{\textsc{Matlab}\xspace}
\newcommand\RR{\mathbb{R}}
\newcommand\vf{\varphi}

\newcommand{\Wlij}{W^l_{i,j}}
\newcommand{\Wij}{W_{i,j}}
\newcommand{\Plij}{P^l_{i,j}}
\newcommand{\Pij}{P_{i,j}}
\newcommand{\Ylij}{Y^l_{i,j}}
\newcommand{\Yij}{Y_{i,j}}
\newcommand{\upp}[3]{\big<#1\big|_{#3}\,#2\big>}

\newcommand{\Nbreen}{Nordenski\"oldbreen\xspace}


\title[]{Notes on 2014 McCarthy projects}

\author[]{Ed Bueler}


\begin{document}
%\graphicspath{{../figs/}}

\scriptsize \hfill \today \normalsize
\vspace{0.5in}

\maketitle
\thispagestyle{empty}

\setcounter{equation}{14}

\section*{PROJECT 5: Models for hydrology and sliding on the Kennicott glacier}

\begin{quote}
\noindent ADVISOR: Ed Bueler

\medskip
\noindent DESCRIPTION: We will follow \cite{Bartholomausetal2011} in building a ``lumped'' numerical model of the hydrology and sliding of the Kennicott glacier during summer conditions, especially considering the sliding generated by the annual flood from the drainage of Hidden Creek Lake.  Their model involves ordinary differential equations and is well-constrained by data.  Then we'll look at either inverting the model for subglacial parameters or extending the model to a flowline where different parts of the glacier can respond at different rates.

\medskip
\noindent SOFTWARE REQUIREMENTS: Matlab or Octave

\medskip
\noindent REQUIRED STUDENT BACKGROUND: Minimal exposure to differential equations and use of Matlab or similar.
\end{quote}

\subsection*{Details}  I'll refer to  \cite{Bartholomausetal2011} as ``Barth.''  Please read it first.  Note that my J.~Glaciol.~``Correspondence'' \citep{Bueler2014correspondence} is an attempt to clarify Barth for the modern reader!

The basic mass conservation idea is unstated (but implicit) in Barth:
\begin{equation}
\frac{dS}{dt} = Q_{in} - Q_{out}. \label{eq:massconserve}
\end{equation}
Also unstated in Barth, but implicit, is the basic decomposition $S = S_{en} + S_{sub}$ to give the total storage in terms of the englacial and subglacial parts.  The great advantage of the Barth model, which works for the Kennicott glacier, is that the input and output fluxes $Q_{in},Q_{out}$ are \emph{measured time series}.

Barth basically uses total storage $S$ and cavity cross-sectional area $A_c$ as the evolving variables.  Barth gives equation (4) for $A_c$.  To match other subglacial hydrology literature \citep[for example]{Hewitt2011}, however, it might help to think in terms of subglacial water pressure $P$ and the cavity size $A_c$ as the primary variables, as below.  Note that $A_c$ is equivalent to the average bed separation.  Because the subglacial cavities are full in this model, however, $A_c$ is also equivalent to the thickness of the subglacial water layer.

Observe $P = \rho_w g z_w$ is implicit in equation (2) in Barth; this is the ``piezometer'' idea.  From equation (1) in Barth this means $P = ((\rho_w g)/(LW\phi)) S_{en}$.  Also $S_{sub} = (fLW/h) A_c$ follows from reading the text on the bedrock bumps.  Thus, given the pair $A_c,P$ we can recover the pair $S_{en},S_{sub}$, and vice-versa.

I suggest actually using these equations from my Correspondence \citep{Bueler2014correspondence}:
\begin{equation}
\frac{dA_c}{dt} = u_b h + Z - C_c A_c (P_o-P)^n,  \label{eq:cavityevolution}
\end{equation}
and
\begin{equation}
\frac{dP}{dt} = \frac{\rho_w g}{L W \phi} \left(Q_{in}(t) - Q_{out}(t) - \frac{f L }{h} \frac{d A_c}{dt}\right), \label{eq:pressureevolution}
\end{equation}
because this pair of evolution equations is closer to the modern subglacial paradigm laid out by \cite{Hewitt2011} (e.g.~see his equation (10)).  This ODE system can be treated as
\begin{equation}
M \frac{d\bv}{dt} = G(t,\bv) \label{eq:system}
\end{equation}
where $\mathbf{v}$ is the vector of two unknowns $A_c,P$, and $M$ is a fixed lower triangular matrix, and $G$ is the formula from the right sides of equations \eqref{eq:cavityevolution} and \eqref{eq:pressureevolution}.  Note melt $Z$ in \eqref{eq:cavityevolution} is determined by (4) in Barth from geometric and/or known constants and $Q_{out}$; i.e.~$Z=\alpha Q_{out}$ where $\alpha$ is constant.

To determine sliding, note equation (1) in Barth gives $z_w$ from $S_{en}$, thus $P$, and then equation (2) from Barth gives the effective pressure $N$.  Then equation (3) in Barth gives sliding velocity $u_b$.  The combination gives this formula for sliding in terms of $P$:
\begin{equation}
u_b = \frac{C \tau_b^n}{(P_o - P)^\gamma} \label{eq:sliding}
\end{equation}
where $P_o=\rho_i g H$ is the ice overburden pressure.  This equation can be used by post-processing on the solution to the ODE system.

Use ODE solver to solve system \eqref{eq:system} above.  Values of $\phi,g,\rho_w,h,w_c,\lambda_x,\lambda_y,f,\gamma,k=C\tau_b^n$ are all given on page 999 in Barth.

Do the synthetic case from Figure 6 in Barth first.  Then use data from Tim in file \texttt{Bartholomaus2011_Fig7.txt} and get Figure 7 in Barth.  View the data, and see by example how to read it, by running \texttt{showbarthdata.m} in Octave or Matlab.

\subsection*{Comments}  Instead of the above strategy, one could instead use ODE system \eqref{eq:massconserve} and \eqref{eq:cavityevolution} with $P$ in \eqref{eq:cavityevolution} written as $P= c_1 S_{en} = c_1 (S - S_{sub}) = c_1 (S - c_2 A_c)$; this is closer to what Barth did.

The following extensions are probably not something we will get to, but they might help conceptually to state:

\begin{itemize}

\item[Extension 1.\quad] \emph{Inversion for subglacial parameters}.  From formula (4) in Barth for the evolution of $A_c$, it makes sense, given all that is \emph{unknown} subglacially, to write equation \eqref{eq:cavityevolution} as
\begin{equation}
\frac{dA_c}{dt} = \beta u_b + \alpha Q_{out} - C_c A_c (P_o-P)^n. \label{eq:cavityevolutionforinversion}
\end{equation}
Then one could do inversion for $\alpha,\beta,C_c$ to fit data from Figure 8.  (For now this would require hand-digitizing Figure 8a.)  Roughly $\alpha$ is a scale for melting as a cavity-opening process, $\beta$ is a scale for mechanical cavity-opening processes, and $C_c$ is a scale for all cavity-closure processes.

\item[Extension 2.\quad] \emph{Distributed version of the model}.  From Correspondence \citep{Bueler2014correspondence} we have a PDE for a distributed flowline version:
\begin{equation}
\frac{\phi W}{\rho_w g} \frac{\partial P}{\partial t} = - \frac{\partial Q}{\partial x} - \frac{f}{h} \left[u_b h + Z - C_c A_c (P_o-P)^n\right]. \label{eq:barth:distpressure}
\end{equation}
Using this requires speculation on Darcy flux, a formula for $Q$ in terms of $A_c$ and other variables; see also \cite{BuelervanPeltDRAFT} on this topic.

\end{itemize}



\newpage
\section*{Project 6: From ice shelves in the lab to good numerical models}

\begin{quote}
\noindent ADVISOR: Ed Bueler

\medskip
\noindent DESCRIPTION:  Ice shelves and ice streams meet at grounding lines.  One of the keys to effective modelling of the evolving Antarctic ice sheet is capturing the way grounding lines move.  New laboratory models using glycerine and salt water give well-measured moving grounding lines and ice shelves.  For a strong-lateral-confinement-case laboratory model \citep{Pegleretal2013} we will build simple numerical schemes for the shallow equations which describe the dynamics.  Bypassing the speculative literature of numerical grounding line modelling, we'll have the chance to be actually wrong: we will know the misfit between the numerical model and the observations.

\medskip
\noindent SOFTWARE REQUIREMENTS: Matlab or Octave

\medskip
\noindent REQUIRED STUDENT BACKGROUND: Minimal exposure to differential equations and use of Matlab or similar.
\end{quote}

\subsection*{Details}  I'll refer to  \cite{Pegleretal2013} as ``Pegler.''  Please read it first.

These Cambridge applied math types have built \emph{laboratory} fluid analogs of glacier and ice sheet flows.  They have built such analogs for moving-margin grounded ice sheets \citep{SayagWorster2013}, radial marine ice sheets with moving grounding lines \citep{PeglerWorster2012,SayagPeglerWorster2012}, and the laterally-confined flow-line marine ice sheet which we will look at in detail here (i.e.~Pegler).  I am interested in this work because I want ice sheet numerical models to be able to accurately approximate (i.e.~``reproduce'') these laboratory results.  Such laboratory experiments, which are better-measured flows than the poorly-observed ice sheets themselves, should be used to validate numerical ice sheet models.

My McCarthy lectures, and the notes that go with them which you have in your binder, do indeed introduce the dynamics of flow-line ice shelves.  But I do it in the unconfined case.  That is, there is no ``side drag'' for my ice shelf example, which comes from van der Veen.  In fact, Pegler addresses one end of a range of possible flow-line ice shelves (very confined), and van der Veen addresses the other (unconfined).  Therefore, please skim the ice shelf material in my notes as soon as you can, but note that you will not need detailed knowledge from them.

Instead, the project is to build a numerical approximation of the continuum model in Pegler.  Then to produce time-dependent output from your numerical model that looks like Figures 2 and 5 in Pegler.  Then you can actually measure the difference between experiment (read from the figures) and the numerical model.

Note that the dashed curves in Figure 2 in Pegler, and the solid curves in Figure 5, are from a by-hand calculation.  Specifically, that by-hand calculation gives formula (3.17a,b) which is a ``similarity solution'' to the continuum model.  But you don't need to know that!  Instead, the project is to just build a numerical solution to the continuum model, and compare its output to the experimental results (as shown in Figure 2 and 5).  Thus there is no need to understand Pegler beyond equation (3.9).

The continuum model you want to understand is in equations (3.1a,b), (3.5a,b), (3.6), (3.7), (3.8a,b), and (3.9a,b).  Please read these equations, and discuss them with me and your colleagues, until you have some understanding of them.  I suggest you start by making your own table of notation, which is something missing from Pegler as you will see.

The main equation is (3.6), a partial differential equation (PDE).  It is a ``porous medium equation'', and which is a ``nonlinear diffusion'' (as stated by Pegler).  Thus you can think about it as the kind of heat flow equation which is addressed in my lectures and notes.  But wherein the unknown is ``ice'' thickness, instead of temperature as in the ordinary heat equation.

To help you, I will provide a worked-out assignment (``Assignment \#8'') from a course I just taught this spring on numerical PDEs.  This assignment addresses a similar porous medium equation.  Also I will supply the Matlab codes from the assignment.  Thus you do not, by any means, need to start from scratch on building a numerical method.

There are two interesting aspects of this problem, as a diffusion PDE problem.  One is that there is a coefficient in (3.6) that changes discontinuously.  This discontinuity is stated in (3.5a,b), but see also (3.1a,b) and (3.8a,b) which are closely-related.  This discontinuity is the (famous?) ``grounding line issue'', but in this laterally-confined case it is less troublesome than in less-confined marine ice sheet cases \citep[in particular]{SchoofMarine1}.  Nonetheless you will probably see numerical effects from it, for example if you plot the flux output $q(t,x)$ as a function of $x$ at some time $t$.

The other interesting aspect is in equation (3.9a,b).  The unknown location of the ``ice'' shelf front is a ``free boundary''.  I claim that as long as you understand the obvious fact ``$H\ge 0$'', then you can ignor the (3.9b) and still get the rate of motion of the shelf front correct (in a numerical approximation sense).  That is, I assert that (3.9b) is not really needed.

\subsection*{Comments}  You might be interested in where equation (3.6) in Pegler comes from.  First of all, section 7.6 of \cite{Acheson} explains where equations (3.2) come from; I can supply this book if you are interested.  Then the calculation described on page 722\footnote{Namely, ``By integrating (3.2a) subject to no-slip conditions at the cell walls, and using the integrated form of (3.2b) to substitute for the leading-order hydrostatic pressure, we determine \dots''} gives (3.4a,b), but this integration isprobably not obvious.  Nonetheless I can supply the details.


\small
\bibliography{ice-bib}  % generally requires link to pism/doc/ice-bib.bib
\bibliographystyle{agu}

\end{document}
